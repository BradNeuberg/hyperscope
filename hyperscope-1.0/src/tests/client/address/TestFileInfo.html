<html>
	<head>
		<title>Test Page for hs.address.FileInfo</title>
		
		<script language="javascript" src="../lib/jsunit/app/jsUnitCore.js"></script>

		<script type="text/javascript" src="../../../client/lib/sarissa/sarissa.js"></script>
		<script type="text/javascript" src="../../../client/lib/sarissa/sarissa_ieemu_xpath.js"></script>
		
		<script type="text/javascript">
			var djConfig = { testing: true, isDebug: true, disableFlashStorage: true };
		</script>
		<script type="text/javascript" src="../../../client/lib/dojo/dojo.js.uncompressed.js"></script>
		
		<script type="text/javascript" src="../../../client/lib/hs/exception.js"></script>
		<script type="text/javascript" src="../../../client/lib/hs/filter.js"></script>
		<script type="text/javascript" src="../../../client/lib/hs/util.js"></script>
		<script type="text/javascript" src="../../../client/lib/hs/address.js"></script>
		<script type="text/javascript" src="../../../client/lib/hs/model.js"></script>
		<script type="text/javascript" src="../../../client/lib/hs/commands.js"></script>
		<script type="text/javascript" src="../../../client/lib/hs/ui.js"></script>
	</head>
	<body>
		<h1>Test Page for hs.address.FileInfo</h1>

		<p>This page contains a suite of tests for testing
		HyperScope.</p>
	
		<script language="javascript">
			// wait for page to finish loading
			dojo.event.connect(dojo, "loaded", pageLoaded);
			
			function setUpPage(){
			}
			
			function pageLoaded(){
				debug("page loaded");
				setUpPageStatus = "complete";
			}
			
			function testFileInfo(){
				var f, f2, url, exp = null;
				
				info("---TestFileInfo:testFileInfo()");

				// NON-RELATIVE ADDRESSES
				url = "http://bootstrap.org";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("bootstrap.org", f.host);
				assertEquals("/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://bootstrap.org/", f.toString());
				
				url = "http://bootstrap.org:100/someDir/someFile?query1=query2#3A:x";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(100, f.port);
				assertEquals("bootstrap.org", f.host);
				assertEquals("/someDir/someFile/", f.path);
				assertEquals("?query1=query2", f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://bootstrap.org:100/someDir/someFile/?query1=query2", f.toString());
				
				url = "http://bootstrap.org:100/someDir/someFile.opml?query1=query2#3A:x";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(100, f.port);
				assertEquals("bootstrap.org", f.host);
				assertEquals("/someDir/someFile.opml", f.path);
				assertEquals("?query1=query2", f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://bootstrap.org:100/someDir/someFile.opml?query1=query2", f.toString());
				
				url = "http://bootstrap.org:100/someDir/someFile.opml?#3A:x";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(100, f.port);
				assertEquals("bootstrap.org", f.host);
				assertEquals("/someDir/someFile.opml", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://bootstrap.org:100/someDir/someFile.opml", f.toString());
				
				url = "http://bootstrap.org/some Dir/some File.opml?query1=qu %2B%2C%26er%20y2#3A:x";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("bootstrap.org", f.host);
				assertEquals("/some Dir/some File.opml", f.path);
				assertEquals("?query1=qu %2B%2C%26er y2", f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://bootstrap.org/some Dir/some File.opml?query1=qu %2B%2C%26er y2", f.toString());
				
				url = "https://bootstrap.org:100/someDir/someFile.opml?query1=query2#3A:x";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("https", f.scheme);
				assertEquals(100, f.port);
				assertEquals("bootstrap.org", f.host);
				assertEquals("/someDir/someFile.opml", f.path);
				assertEquals("?query1=query2", f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("https://bootstrap.org:100/someDir/someFile.opml?query1=query2", f.toString());
				
				url = "http://bootstrap.org/../someDir/someFile.opml#0";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("bootstrap.org", f.host);
				assertEquals("/../someDir/someFile.opml", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://bootstrap.org/../someDir/someFile.opml", f.toString());
				
				url = "http://bootstrap.org/someDir/";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("bootstrap.org", f.host);
				assertEquals("/someDir/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://bootstrap.org/someDir/", f.toString());
				
				url = "http://bootstrap.org/someDir";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("bootstrap.org", f.host);
				assertEquals("/someDir/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://bootstrap.org/someDir/", f.toString());
				
				url = "http://bootstrap.org/directory with spaces";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("bootstrap.org", f.host);
				assertEquals("/directory with spaces/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://bootstrap.org/directory with spaces/", f.toString());
				
				
				// RELATIVE ADDRESSES
				
				url = "someFile.opml#023+2w";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("someFile.opml", f.path);
				assertNull(f.query);
				// full paths
				assertFalse(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("someFile.opml", f.toString());
				
				url = "#023+2w";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("./", f.path);
				assertNull(f.query);
				// full paths
				assertFalse(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("./", f.toString());
				
				url = "someFile.opml";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("someFile.opml", f.path);
				assertNull(f.query);
				// full paths
				assertFalse(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("someFile.opml", f.toString());
				
				url = "someFile.opml#";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("someFile.opml", f.path);
				assertNull(f.query);
				// full paths
				assertFalse(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("someFile.opml", f.toString());
				
				url = "../../someDir/someFile.opml#label:x";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("../../someDir/someFile.opml", f.path);
				assertNull(f.query);
				// full paths
				assertFalse(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("../../someDir/someFile.opml", f.toString());
				
				url = "index.html";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("index.html", f.path);
				assertNull(f.query);
				// full paths
				assertFalse(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("index.html", f.toString());
				
				url = "foobar";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("foobar/", f.path);
				assertNull(f.query);
				// full paths
				assertFalse(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("foobar/", f.toString());
				
				url = ".";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("./", f.path);
				assertNull(f.query);
				// full paths
				assertFalse(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("./", f.toString());
				
				url = "..";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("../", f.path);
				assertNull(f.query);
				// full paths
				assertFalse(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("../", f.toString());
				
				url = "/";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("/", f.toString());
				
				url = "http://bootstrap.org/./";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("bootstrap.org", f.host);
				assertEquals("/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://bootstrap.org/", f.toString());
				
				url = "/someFile.opml?foobar";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("/someFile.opml", f.path);
				assertEquals("?foobar", f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("/someFile.opml?foobar", f.toString());
				
				url = "/HYARCH.AUG.66.DIR/HYARCH.AUG.66-hyperscope.opml?foobar";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("/HYARCH.AUG.66.DIR/HYARCH.AUG.66-hyperscope.opml", f.path);
				assertEquals("?foobar", f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("/HYARCH.AUG.66.DIR/HYARCH.AUG.66-hyperscope.opml?foobar", f.toString());
				
				url = "/someDir";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("/someDir/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("/someDir/", f.toString());
				
				url = "/someDir/";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("/someDir/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("/someDir/", f.toString());
				
				url = "http://bootstrap.org/important/anotherfile.opml?anotherparam=helloworld#025:yxO";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("bootstrap.org", f.host);
				assertEquals("/important/anotherfile.opml", f.path);
				assertEquals("?anotherparam=helloworld", f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://bootstrap.org/important/anotherfile.opml?anotherparam=helloworld", f.toString());
				
				url = "";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("./", f.path);
				assertNull(f.query);
				// full paths
				assertFalse(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("./", f.toString());
				// adding files and paths
				
				url = "     ";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("./", f.path);
				assertNull(f.query);
				// full paths
				assertFalse(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("./", f.toString());
				
				url = "codinginparadise.org/somedir";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("codinginparadise.org", f.host);
				assertEquals("/somedir/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://codinginparadise.org/somedir/", f.toString());
				
				url = "codinginparadise.org";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("codinginparadise.org", f.host);
				assertEquals("/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://codinginparadise.org/", f.toString());
				
				url = "codinginparadise.org/somedir/somefile.opml";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("codinginparadise.org", f.host);
				assertEquals("/somedir/somefile.opml", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://codinginparadise.org/somedir/somefile.opml", f.toString());
				
				url = "192.168.1.1/somedir";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("192.168.1.1", f.host);
				assertEquals("/somedir/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://192.168.1.1/somedir/", f.toString());
				
				url = "192.168.1.1";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("192.168.1.1", f.host);
				assertEquals("/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://192.168.1.1/", f.toString());
				
				url = "192.168.1.1/somedir/somefile.opml";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("192.168.1.1", f.host);
				assertEquals("/somedir/somefile.opml", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://192.168.1.1/somedir/somefile.opml", f.toString());
				
				url = "google.fr";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("google.fr", f.host);
				assertEquals("/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://google.fr/", f.toString());
				
				url = "google.fr:7070";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(7070, f.port);
				assertEquals("google.fr", f.host);
				assertEquals("/", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://google.fr:7070/", f.toString());
				
				url = "google.fr/somedir/somefile.opml";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("google.fr", f.host);
				assertEquals("/somedir/somefile.opml", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://google.fr/somedir/somefile.opml", f.toString());
				
				url = "google.fr:7070/somedir/somefile.opml";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(7070, f.port);
				assertEquals("google.fr", f.host);
				assertEquals("/somedir/somefile.opml", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://google.fr:7070/somedir/somefile.opml", f.toString());
				
				url = "sub.google.fr/somedir/somefile.opml";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertEquals("sub.google.fr", f.host);
				assertEquals("/somedir/somefile.opml", f.path);
				assertNull(f.query);
				// full paths
				assertTrue(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("http://sub.google.fr/somedir/somefile.opml", f.toString());
				
				url = "somefile.opml";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("somefile.opml", f.path);
				assertNull(f.query);
				// full paths
				assertFalse(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("somefile.opml", f.toString());
				
				url = "somefile.xml";
				info("url: " + url);
				f = new hs.address.FileInfo(url);
				// check basic properties
				assertEquals("http", f.scheme);
				assertEquals(80, f.port);
				assertNull(f.host);
				assertEquals("somefile.xml", f.path);
				assertNull(f.query);
				// full paths
				assertFalse(f.hasFullPath());
				// clone
				assertTrue(f.equals(f.clone()));
				// toString
				assertEquals("somefile.xml", f.toString());
				
				
				
				
				
				// INVALID ADDRESSES
				url = null;
				info("INVALID: url: " + url);
				exp = null;
				try{ 
					f = new hs.address.FileInfo(url); 
				}catch(e){
					exp = e;
				}
				assertNotNull(exp);
				
				url = undefined;
				info("INVALID: url: " + url);
				exp = null;
				try{ 
					f = new hs.address.FileInfo(url); 
				}catch(e){
					exp = e;
				}
				assertNotNull(exp);
				
				url = "http://";
				info("INVALID: url: " + url);
				exp = null;
				try{ 
					f = new hs.address.FileInfo(url); 
				}catch(e){
					exp = e;
				}
				assertNotNull(exp);
				
				url = "file://";
				info("INVALID: url: " + url);
				exp = null;
				try{ 
					f = new hs.address.FileInfo(url); 
				}catch(e){
					exp = e;
				}
				assertNotNull(exp);
				
				url = "http://http://";
				info("INVALID: url: " + url);
				exp = null;
				try{ 
					f = new hs.address.FileInfo(url); 
				}catch(e){
					exp = e;
				}
				assertNotNull(exp);
				
				url = "asdf//////asdf";
				info("INVALID: url: " + url);
				exp = null;
				try{ 
					f = new hs.address.FileInfo(url); 
				}catch(e){
					exp = e;
				}
				assertNotNull(exp);
				
				url = "http://bootstrap.org/someDir????test?test";
				info("INVALID: url: " + url);
				exp = null;
				try{ 
					f = new hs.address.FileInfo(url); 
				}catch(e){
					exp = e;
				}
				assertNotNull(exp);
				
				url = "mailto:bkn3@columbia.edu";
				info("INVALID: url: " + url);
				exp = null;
				try{ 
					f = new hs.address.FileInfo(url); 
				}catch(e){
					exp = e;
				}
				assertNotNull(exp);
				
				url = "file://";
				info("INVALID: url: " + url);
				exp = null;
				try{ 
					f = new hs.address.FileInfo(url); 
				}catch(e){
					exp = e;
				}
				assertNotNull(exp);
				
				url = "file://foobar.xml/";
				info("INVALID: url: " + url);
				exp = null;
				try{ 
					f = new hs.address.FileInfo(url); 
				}catch(e){
					exp = e;
				}
				assertNotNull(exp);
				
				url = "file://test";
				info("INVALID: url: " + url);
				exp = null;
				try{ 
					f = new hs.address.FileInfo(url); 
				}catch(e){
					exp = e;
				}
				assertNotNull(exp);
				
				url = "file://test.xml";
				info("INVALID: url: " + url);
				exp = null;
				try{ 
					f = new hs.address.FileInfo(url); 
				}catch(e){
					exp = e;
				}
				assertNotNull(exp);
			}
			
			function testEquals(){
				var f1, f2;
				var url1, url2;
				
				info("---TestFileInfo:testEquals()");
				
				url1 = "http://bootstrap.org";
				url2 = "http://bootstrap.org";
				info("testing: " + url1 + " == " + url2);
				f1 = new hs.address.FileInfo(url1);
				f2 = new hs.address.FileInfo(url2);
				assertTrue(f1.equals(f2));
				
				url1 = "http://bootstrap.org";
				url2 = "http://bootstrap.org:100/someDir/someFile?query1=query2#3A:x";
				info("testing: " + url1 + " != " + url2);
				f1 = new hs.address.FileInfo(url1);
				f2 = new hs.address.FileInfo(url2);
				assertFalse(f1.equals(f2));
				
				url1 = "http://bootstrap.org:100/someDir/someFile?query1=query2#3A:x";
				url2 = "http://bootstrap.org:100/someDir/someFile?query1=query2#3A:x";
				info("testing: " + url1 + " == " + url2);
				f1 = new hs.address.FileInfo(url1);
				f2 = new hs.address.FileInfo(url2);
				assertTrue(f1.equals(f2));
				
				url1 = "someFile.opml#023+2w";
				url2 = "http://bootstrap.org:100/someDir/someFile?query1=query2#3A:x";
				info("testing: " + url1 + " != " + url2);
				f1 = new hs.address.FileInfo(url1);
				f2 = new hs.address.FileInfo(url2);
				assertFalse(f1.equals(f2));
				
				url1 = "someFile.opml#023+2w";
				url2 = "someFile.opml#023+2w";
				info("testing: " + url1 + " != " + url2);
				f1 = new hs.address.FileInfo(url1);
				f2 = new hs.address.FileInfo(url2);
				assertTrue(f1.equals(f2));
				
				url1 = "#023+2w";
				url2 = "someFile.opml#023+2w";
				info("testing: " + url1 + " != " + url2);
				f1 = new hs.address.FileInfo(url1);
				f2 = new hs.address.FileInfo(url2);
				assertFalse(f1.equals(f2));
				
				url1 = "#023+2w";
				url2 = "#023+2w";
				info("testing: " + url1 + " == " + url2);
				f1 = new hs.address.FileInfo(url1);
				f2 = new hs.address.FileInfo(url2);
				assertTrue(f1.equals(f2));
				
				url1 = ".";
				url2 = "./";
				info("testing: " + url1 + " == " + url2);
				f1 = new hs.address.FileInfo(url1);
				f2 = new hs.address.FileInfo(url2);
				assertTrue(f1.equals(f2));
				
				url1 = ".";
				url2 = "http://bootstrap.org:100/someDir/someFile?query1=query2#3A:x";
				info("testing: " + url1 + " != " + url2);
				f1 = new hs.address.FileInfo(url1);
				f2 = new hs.address.FileInfo(url2);
				assertFalse(f1.equals(f2));
				
				url1 = ".";
				url2 = "new Object()";
				info("testing: " + url1 + " != " + url2);
				f1 = new hs.address.FileInfo(url1);
				assertFalse(f1.equals(new Object()));
			}
			
			function testExpandRelative(){
				var url, f, expandFile, expandAgainst, expanded;
				var exp = null;
				
				info("---TestFileInfo:testExpandRelative()");

				url = "foobar.opml";
				expandAgainst = "http://bootstrap.org";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/foobar.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "#@somemarker:t";
				expandAgainst = "http://bootstrap.org";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/", expanded.toString());
				assertEquals("./", f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "../../documents/hyarch.opml";
				expandAgainst = "http://bootstrap.org";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/documents/hyarch.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "../../documents/hyarch.opml";
				expandAgainst = "http://bootstrap.org/";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/documents/hyarch.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "#foobar";
				expandAgainst = "http://bootstrap.org/";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/", expanded.toString());
				assertEquals("./", f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "../../documents/hyarch.opml";
				expandAgainst = "http://bootstrap.org/important";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/documents/hyarch.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "#023 \"search\"";
				expandAgainst = "http://bootstrap.org/important";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/important/", expanded.toString());
				assertEquals("./", f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "../../documents/hyarch.opml";
				expandAgainst = "http://bootstrap.org/important/";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/documents/hyarch.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "../../documents/HYARCH.AUG.66.DIR/HYARCH.AUG.66-hyperscope.opml";
				expandAgainst = "http://bootstrap.org/important/";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/documents/HYARCH.AUG.66.DIR/HYARCH.AUG.66-hyperscope.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "../../documents/HYARCH.AUG.66.DIR/HYARCH.AUG.66-hyperscope.opml";
				expandAgainst = "http://bootstrap.org/important/foobar.opml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/documents/HYARCH.AUG.66.DIR/HYARCH.AUG.66-hyperscope.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "HYARCH.AUG.66-hyperscope.opml";
				expandAgainst = "http://bootstrap.org/important/foobar.opml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/important/HYARCH.AUG.66-hyperscope.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "../../documents/HYARCH.AUG.66.DIR/";
				expandAgainst = "http://bootstrap.org/important/foobar.opml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/documents/HYARCH.AUG.66.DIR/", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "#023:x;foobar;";
				expandAgainst = "http://bootstrap.org/HYARCH.AUG.66.DIR/HYARCH.AUG.66-hyperscope.opml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/HYARCH.AUG.66.DIR/HYARCH.AUG.66-hyperscope.opml", expanded.toString());
				assertEquals("./", f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				// created from a bug discovered through TestAddress.html and my
				// local testing environment -- Brad Neuberg, bkn3@columbia.edu
				url = "../../../non_hyp_opml/opml1_0.opml#:w";
				expandAgainst = "http://brad.com:8080/hyperscope/trunk/hyperscope/src/tests/client/address/../../data/user2/neuberg/HYARCH.AUG.66.DIR/HYARCH.AUG.66-hyperscope.opml#027:wlmBO";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://brad.com:8080/hyperscope/trunk/hyperscope/src/tests/data/non_hyp_opml/opml1_0.opml", expanded.toString());
				assertEquals("../../../non_hyp_opml/opml1_0.opml", f.toString());
				assertEquals("http://brad.com:8080/hyperscope/trunk/hyperscope/src/tests/client/address/../../data/user2/neuberg/HYARCH.AUG.66.DIR/HYARCH.AUG.66-hyperscope.opml", expandFile.toString());
				
				url = "/root.opml";
				expandAgainst = "http://bootstrap.org/important";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/root.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "root.opml";
				expandAgainst = "http://bootstrap.org/anotherfile.opml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/root.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "#023";
				expandAgainst = "http://bootstrap.org/anotherfile.opml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/anotherfile.opml", expanded.toString());
				assertEquals("./", f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "directory/somewhere";
				expandAgainst = "http://bootstrap.org/anotherfile.opml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/directory/somewhere/", expanded.toString());
				assertEquals(url + "/", f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "#023";
				expandAgainst = "http://bootstrap.org/anotherfile.opml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/anotherfile.opml", expanded.toString());
				assertEquals("./", f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "directory/somewhere#022:yx";
				expandAgainst = "http://bootstrap.org/anotherfile.opml#022:yx";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/directory/somewhere/", expanded.toString());
				assertEquals("directory/somewhere/", f.toString());
				assertEquals("http://bootstrap.org/anotherfile.opml", expandFile.toString());
				
				url = "./directory/somewhere?someparam=foobar#022:yx";
				expandAgainst = "http://bootstrap.org/important/anotherfile.opml?anotherparam=helloworld#025:yxO";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/important/directory/somewhere/?someparam=foobar", expanded.toString());
				assertEquals("./directory/somewhere/?someparam=foobar", f.toString());
				assertEquals("http://bootstrap.org/important/anotherfile.opml?anotherparam=helloworld", expandFile.toString());
				
				url = "#022:yx";
				expandAgainst = "http://bootstrap.org/important/anotherfile.opml?anotherparam=helloworld#025:yxO";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/important/anotherfile.opml?anotherparam=helloworld", expanded.toString());
				assertEquals("./", f.toString());
				assertEquals("http://bootstrap.org/important/anotherfile.opml?anotherparam=helloworld", expandFile.toString());
				
				url = "#022:yx";
				expandAgainst = "http://bootstrap.org:8080/important/anotherfile.opml?anotherparam=helloworld#025:yxO";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org:8080/important/anotherfile.opml?anotherparam=helloworld", expanded.toString());
				assertEquals("./", f.toString());
				assertEquals("http://bootstrap.org:8080/important/anotherfile.opml?anotherparam=helloworld", expandFile.toString());
				
				url = "?someparam=foobar#022:yx";
				expandAgainst = "http://bootstrap.org/important/anotherfile.opml?anotherparam=helloworld#025:yxO";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/important/anotherfile.opml?someparam=foobar", expanded.toString());
				assertEquals("./?someparam=foobar", f.toString());
				assertEquals("http://bootstrap.org/important/anotherfile.opml?anotherparam=helloworld", expandFile.toString());
				
				url = "?someparam=foobar#022:yx";
				expandAgainst = "http://bootstrap.org/important/?anotherparam=helloworld#025:yxO";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/important/?someparam=foobar", expanded.toString());
				assertEquals("./?someparam=foobar", f.toString());
				assertEquals("http://bootstrap.org/important/?anotherparam=helloworld", expandFile.toString());
				
				url = "#022:yx";
				expandAgainst = "http://bootstrap.org/important/?anotherparam=helloworld#025:yxO";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/important/?anotherparam=helloworld", expanded.toString());
				assertEquals("./", f.toString());
				assertEquals("http://bootstrap.org/important/?anotherparam=helloworld", expandFile.toString());
				
				url = "?someparam=foobar#022:yx";
				expandAgainst = "http://bootstrap.org/important?anotherparam=helloworld#025:yxO";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/important/?someparam=foobar", expanded.toString());
				assertEquals("./?someparam=foobar", f.toString());
				assertEquals("http://bootstrap.org/important/?anotherparam=helloworld", expandFile.toString());
				
				url = "root.opml";
				expandAgainst = "http://bootstrap.org/../.././anotherfile.opml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/root.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "#foobar";
				expandAgainst = "http://bootstrap.org/../.././anotherfile.opml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/anotherfile.opml", expanded.toString());
				assertEquals("./", f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "#Outline:w";
				expandAgainst = "http://bootstrap.org/../.././anotherfile.opml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/anotherfile.opml", expanded.toString());
				assertEquals("./", f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "some windows filename with spaces.opml#55;/asdf/;";
				expandAgainst = "http://bootstrap.org/directory with spaces";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/directory with spaces/some windows filename with spaces.opml", expanded.toString());
				assertEquals("some windows filename with spaces.opml", f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "some windows filename with spaces.opml#55;/asdf/;";
				expandAgainst = "http://bootstrap.org/directory with spaces";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/directory with spaces/some windows filename with spaces.opml", expanded.toString());
				assertEquals("some windows filename with spaces.opml", f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "#55;/asdf/;";
				expandAgainst = "http://bootstrap.org/directory with spaces";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/directory with spaces/", expanded.toString());
				assertEquals("./", f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "http://bootstrap.org/somewhereelse.opml";
				expandAgainst = "http://bootstrap.org/directory with spaces";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertFalse(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals(url, expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "http://foobar.org/somewhereelse.opml";
				expandAgainst = "http://bootstrap.org/directory with spaces";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertFalse(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals(url, expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "/anotherfile.xml";
				expandAgainst = "http://bootstrap.org/directory with spaces";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/anotherfile.xml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "../../anotherfile.xml";
				expandAgainst = "http://bootstrap.org/directory with spaces";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/anotherfile.xml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "../../anotherfile.html";
				expandAgainst = "http://bootstrap.org/directory with spaces";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/anotherfile.html", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst + "/", expandFile.toString());
				
				url = "../../anotherfile.html";
				expandAgainst = "http://bootstrap.org/directory with spaces/foobar.xml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/anotherfile.html", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "../../file with spaces.opml";
				expandAgainst = "http://bootstrap.org/directory with spaces/foobar.xml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/file with spaces.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				// test with wierd port numbers
				url = "../../file with spaces.opml";
				expandAgainst = "http://bootstrap.org:8080/directory with spaces/foobar.xml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org:8080/file with spaces.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				// test with IP address
				url = "../../file with spaces.opml";
				expandAgainst = "http://192.168.1.1:8080/directory with spaces/foobar.xml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://192.168.1.1:8080/file with spaces.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				// test with hostname but no scheme, including port number
				url = "codinginparadise.org/../../file with spaces.opml";
				expandAgainst = "http://bootstrap.org/directory with spaces/foobar.xml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertFalse(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://codinginparadise.org/file with spaces.opml", expanded.toString());
				assertEquals("http://" + url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				// add just .. for url
				url = "..";
				expandAgainst = "http://bootstrap.org/directory with spaces/foobar.xml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/", expanded.toString());
				assertEquals(url + "/", f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				// add just . for url
				url = ".";
				expandAgainst = "http://bootstrap.org/directory with spaces/foobar.xml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/directory with spaces/foobar.xml", expanded.toString());
				assertEquals(url + "/", f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				// do some funky relative .. and . sequences
				url = "../../joe/../../billy/../anotherFile.xml";
				expandAgainst = "http://bootstrap.org/hekka/bekka/billy/bob/joe/shmo/someFile.opml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/hekka/bekka/billy/anotherFile.xml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				url = "./././././././helloworld/../helloworld/../../shmo/../.././joe/anotherFile.opml";
				expandAgainst = "http://bootstrap.org/hekka/bekka/billy/bob/joe/shmo/someFile.opml";
				info("url: " + url);
				info("expandAgainst: " + expandAgainst);
				info("**");
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertFalse(expandFile.isRelative());
				expanded = f.expand(expandFile);
				assertNotNull(expanded);
				assertNotUndefined(expanded);
				assertEquals("http://bootstrap.org/hekka/bekka/billy/bob/joe/anotherFile.opml", expanded.toString());
				assertEquals(url, f.toString());
				assertEquals(expandAgainst, expandFile.toString());
				
				
				// invalid expanding
				
				// expandAgainst is relative
				exp = null;
				url = "../../anotherfile.html";
				expandAgainst = "/foobar.xml";
				info("INVALID: url: " + url);
				info("expandAgainst: " + expandAgainst);
				f = new hs.address.FileInfo(url);
				expandFile = new hs.address.FileInfo(expandAgainst);
				assertTrue(f.isRelative());
				assertTrue(expandFile.isRelative());
				try{
					expanded = f.expand(expandFile);
				}
				catch (e) {
					exp = e;
				}
				assertNotNull(exp);
			}
		</script>
	</body>
</html>